id: 04_postgres_taxi_year_all_month
namespace: zoomcamp
description: |
  The CSV Data used in the course: https://github.com/DataTalksClub/nyc-tlc-data/releases

inputs:
  - id: taxi
    type: SELECT
    displayName: Select taxi type
    values: [yellow, green]
    defaults: yellow

  - id: year
    type: SELECT
    displayName: Select year
    values: ["2019", "2020","2021"]
    defaults: "2019"

tasks:
  - id: process_all_months
    type: io.kestra.plugin.core.flow.ForEach
    values: [ "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12" ]
    tasks:
      - id: process_month
        type: io.kestra.plugin.core.flow.Subflow
        namespace: zoomcamp
        flowId: 04_postgres_taxi
        inputs:
          taxi: "{{inputs.taxi}}"
          year: "{{inputs.year}}"
          month: "{{taskrun.value}}"

